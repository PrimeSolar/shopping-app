const db=new Dexie("ShoppingApp");db.version(1).stores({items:"++id, description, price, quantity, purchased"});const itemForm=document.getElementById("itemForm"),itemsDiv=document.getElementById("itemsDiv"),totalPriceDiv=document.getElementById("totalPriceDiv"),clearButton=document.getElementById("clearButton"),submitButton=document.getElementById("submitButton");let editingItemId=null;async function displayItems(){itemsDiv.innerHTML="";const e=await db.items.toArray();let t=0;e.forEach((e=>{const i=document.createElement("div");i.className="item "+(e.purchased?"purchased":""),i.innerHTML=`\n          <label>\n              <input type="checkbox" class="checkbox" ${e.purchased?"checked":""} onchange="togglePurchased(${e.id}, this.checked)" />\n          </label>\n          <div class="itemInfo">\n              <p>${e.description}</p>\n              <p>${e.quantity} x ${e.price.toFixed(2)}$</p>\n          </div>\n          <div class="button-container">\n              <button type="button" class="editButton" id="editButton${e.id}" onclick="editItem(${e.id}, this)">Edit</button>\n              <button type="button" class="deleteButton" onclick="deleteItem(${e.id})">x</button>\n          </div>\n      `,itemsDiv.appendChild(i),t+=e.quantity*e.price})),totalPriceDiv.innerText=`Total Price: ${t.toFixed(2)}$`}document.addEventListener("DOMContentLoaded",displayItems),itemForm.onsubmit=async e=>{e.preventDefault();const t=document.getElementById("nameInput").value,i=parseInt(document.getElementById("quantityInput").value,10),n=parseFloat(document.getElementById("priceInput").value);editingItemId?(await db.items.update(editingItemId,{description:t,quantity:i,price:n}),editingItemId=null,alert("Item updated successfully.")):(await db.items.add({description:t,quantity:i,price:n,purchased:!1}),alert("Item added successfully.")),itemForm.reset(),displayItems()};const togglePurchased=async(e,t)=>{await db.items.update(e,{purchased:t}),displayItems()},deleteItem=async e=>{confirm("Are you sure you want to delete this item?")&&(await db.items.delete(e),displayItems(),alert("Item deleted successfully."))},editItem=async(e,t)=>{const i=await db.items.get(e);document.getElementById("nameInput").value=i.description,document.getElementById("quantityInput").value=i.quantity,document.getElementById("priceInput").value=i.price,editingItemId=e,t.innerText="Cancel",t.setAttribute("onclick",`cancelEdit(${e}, this)`)},cancelEdit=(e,t)=>{editingItemId=null,itemForm.reset(),t.innerText="Edit",t.setAttribute("onclick",`editItem(${e}, this)`)};clearButton.onclick=async()=>{confirm("Are you sure you want to clear all items?")&&(await db.items.clear(),displayItems(),alert("All items cleared successfully."))};
